# ุดุฑุญ ุชูุตููู: ููู ูุชู ุงูุฑุจุท ูุน Google Sheets

## ุงูููุฏูุฉ

ุงููููุน ูุณุชุฎุฏู **Google Visualization API** ููุงุชุตุงู ุจู Google Sheets ุจุดูู ูุจุงุดุฑ ูุขูู. ูุฐู ุงูุทุฑููุฉ **ูุง ุชุญุชุงุฌ ููุงุชูุญ API ูุนูุฏุฉ** ูุชุนูู ูุน ุฃู ููู ููุดูุฑ ููุนุงูุฉ.

---

## ุงูุฎุทูุฉ 1: ูุดุฑ ููู ุฌูุฌู ุดูุช ููุนุงูุฉ

ูุจู ูุง ูุดุชุบู ุงููููุนุ ูุฌุจ ูุดุฑ ููู ุฌูุฌู ุดูุช:

1. ุงูุชุญ ููู ุฌูุฌู ุดูุช ุงูุฎุงุต ุจู
2. ุงุถุบุท ุนูู **ููู** (File)
3. ุงุฎุชุฑ **ูุดุงุฑูุฉ** (Share)
4. ุงุถุบุท ุนูู **ูุดุฑ ุนูู ุงูููุจ** (Publish to the web)
5. ุงุฎุชุฑ **ุฌุฏูู ูุงูู** ุฃู **ูุฑูุฉ ูุนููุฉ**
6. ุงุถุบุท **ูุดุฑ** (Publish)

ุงูุขู ุงูููู ูุชุงุญ ููุนุงูุฉ ูุฌุงูุฒ ููุฑุจุท!

---

## ุงูุฎุทูุฉ 2: ุงูุญุตูู ุนูู ูุนุฑู ุงูููู (Sheet ID)

ูุนุฑู ุงูููู ููุฌูุฏ ูู ุฑุงุจุท ุฌูุฌู ุดูุช:

```
https://docs.google.com/spreadsheets/d/[SHEET_ID]/edit#gid=0
                                        ^^^^^^^^^^
                                    ูุนุฑู ุงูููู
```

**ูุซุงู:**
```
https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                              ุงูุณุฎ ูุฐุง ุงูุฌุฒุก
```

---

## ุงูุฎุทูุฉ 3: ููู ูุนูู ุงูุฑุจุท ูู ุงูููุฏ

### ุงูุทุฑููุฉ ุงููุณุชุฎุฏูุฉ: Google Visualization Query Language (GVQL)

ุงููููุน ูุณุชุฎุฏู ูุฐุง ุงูุฑุงุจุท ููุงุชุตุงู:

```javascript
const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
```

**ุดุฑุญ ุงูุฑุงุจุท:**
- `docs.google.com/spreadsheets/d/${sheetId}` โ ูุนุฑู ุงูููู
- `/gviz/tq` โ ููุทุฉ ุงูุงุชุตุงู (Google Visualization Query)
- `tqx=out:json` โ ุงุทูุจ ุงูุจูุงูุงุช ุจุตูุบุฉ JSON
- `sheet=${sheetName}` โ ุงุณู ุงููุฑูุฉ (ูุซู Sheet1)

### ูุซุงู ุนููู:

```javascript
// 1. ุจูุงุก ุงูุฑุงุจุท
const sheetId = "1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms";
const sheetName = "Sheet1";
const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

// 2. ุฌูุจ ุงูุจูุงูุงุช
const response = await fetch(url);
const text = await response.text();

// 3. ุชูุธูู ุงูุงุณุชุฌุงุจุฉ (ุฅุฒุงูุฉ ุงูุจุงุฏุฆุฉ)
const jsonText = text.substring(47).slice(0, -2);

// 4. ุชุญููู ุฅูู JSON
const json = JSON.parse(jsonText);

// 5. ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
const table = json.table;
const headers = table.cols.map(col => col.label);
const rows = table.rows.map(row => {
  const rowData = {};
  row.c.forEach((cell, index) => {
    rowData[headers[index]] = cell?.v?.toString() || "";
  });
  return rowData;
});
```

---

## ุงูุฎุทูุฉ 4: ุงูุชุญุฏูุซ ุงูุชููุงุฆู (Auto-Refresh)

ุงููููุน ูุฏุนู ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูู 5 ุซูุงูู:

```javascript
useEffect(() => {
  if (autoRefresh && sheetId) {
    const interval = setInterval(() => {
      fetchSheetData(); // ุฌูุจ ุงูุจูุงูุงุช ูุฑุฉ ุฃุฎุฑู
    }, 5000); // ูู 5000 ูููู ุซุงููุฉ (5 ุซูุงูู)

    return () => clearInterval(interval);
  }
}, [autoRefresh, sheetId]);
```

**ููู ูุนูู:**
1. ุนูุฏูุง ุชูุนู "ุงูุชุญุฏูุซ ุงูุชููุงุฆู"ุ ูุจุฏุฃ ุงูุนุฏ ุงูุชูุงุฒูู
2. ูู 5 ุซูุงููุ ุงููููุน ูุฌูุจ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ูู ุฌูุฌู ุดูุช
3. ุฅุฐุง ุญุฏุซุช ุชุบููุฑุงุช ูู ุงููููุ ุชุธูุฑ ูุจุงุดุฑุฉ ุนูู ุงููููุน
4. ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ุงูุตูุญุฉ ูุฏููุง

---

## ุงูุฎุทูุฉ 5: ูููู ุงูุจูุงูุงุช ุงููุชููุน

ุฌูุฌู ุดูุช ูุฌุจ ุฃู ูููู ุจูุฐุง ุงูุดูู:

| ุงูุงุณู | ุงูุจุฑูุฏ | ุงููุงุชู |
|------|-------|--------|
| ุฃุญูุฏ | ahmad@example.com | 0501234567 |
| ูุงุทูุฉ | fatima@example.com | 0509876543 |

**ุงูุตู ุงูุฃูู = ุฑุคูุณ ุงูุฃุนูุฏุฉ (Headers)**
**ุงูุตููู ุงูุชุงููุฉ = ุงูุจูุงูุงุช (Data)**

---

## ุงููููุฒุงุช

โ **ูุง ุชุญุชุงุฌ ููุงุชูุญ API ูุนูุฏุฉ**
โ **ุชุญุฏูุซ ููุฑู** - ุฃู ุชุบููุฑ ูู ุฌูุฌู ุดูุช ูุธูุฑ ุนูู ุงููููุน
โ **ุขูู** - ูุง ุชุญุชุงุฌ ุญูุธ ูููุงุช ูุฑูุฑ
โ **ูุฌุงูู** - Google Sheets ูุฌุงูู ูุณูู ุงูุงุณุชุฎุฏุงู
โ **ุณุฑูุน** - ุงูุจูุงูุงุช ุชุญูู ูู ุฃูู ูู ุซุงููุฉ

---

## ุงููุญุฏูุฏูุฉ

โ๏ธ **ูุฌุจ ูุดุฑ ุงูููู ููุนุงูุฉ** - ูุง ูููู ุงุณุชุฎุฏุงู ูููุงุช ุฎุงุตุฉ
โ๏ธ **ุญุฏ ุฃูุตู ููุทูุจุงุช** - Google ูุฏููุง ุญุฏ ุฃูุตู ููุทูุจุงุช ุงููุชุฒุงููุฉ
โ๏ธ **ุงูุชุฃุฎูุฑ ุงูุจุณูุท** - ูุฏ ูููู ููุงู ุชุฃุฎูุฑ 1-2 ุซุงููุฉ ูู ุงูุชุญุฏูุซ

---

## ูุซุงู ูุงูู ููุงุณุชุฎุฏุงู

1. **ุฃูุดุฆ ุฌูุฌู ุดูุช** ุจูุฐู ุงูุจูุงูุงุช:
   ```
   ุงุณู ุงูููุชุฌ | ุงูุณุนุฑ | ุงููููุฉ
   ูุงุจุชูุจ | 5000 | 10
   ูุงูุณ | 50 | 100
   ```

2. **ุงูุณุฎ ูุนุฑู ุงูููู** ูู ุงูุฑุงุจุท

3. **ุงูุชุญ ุงููููุน** ูุฃุฏุฎู:
   - ูุนุฑู ุงูููู
   - ุงุณู ุงููุฑูุฉ (Sheet1)

4. **ุงุถุบุท "ุชุญููู ุงูุจูุงูุงุช"**

5. **ูุนูู "ุงูุชุญุฏูุซ ุงูุชููุงุฆู"** ุฅุฐุง ุฃุฑุฏุช

6. **ุนุฏูู ุงูุจูุงูุงุช ูู ุฌูุฌู ุดูุช** ูุดูู ุงููููุน ูุชุญุฏุซ ุชููุงุฆูุงู!

---

## ุงูุฎูุงุตุฉ

ุงูุฑุจุท ูุนูู ุจู 3 ุฎุทูุงุช ุจุณูุทุฉ:

1. **ูุดุฑ** ููู ุฌูุฌู ุดูุช ููุนุงูุฉ
2. **ูุณุฎ** ูุนุฑู ุงูููู ูู ุงูุฑุงุจุท
3. **ูุตู** ุงููุนุฑู ูู ุงููููุน ูุชุญููู ุงูุจูุงูุงุช

ูุงูุจุงูู ูุชู ุชููุงุฆูุงู! ๐
